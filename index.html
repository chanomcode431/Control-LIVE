<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TikTok Remote Control</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    <style>
        body { font-family: 'Segoe UI', Tahoma, sans-serif; padding: 20px; text-align: center; background: #f2f2f2; color: #333; }
        .container { background: white; padding: 30px; border-radius: 15px; max-width: 400px; margin: 20px auto; box-shadow: 0 4px 10px rgba(0,0,0,0.1); }
        h1 { margin-top: 0; color: #444; }
        .input-box { margin: 20px 0; }
        input[type="number"] { font-size: 40px; width: 100px; text-align: center; padding: 10px; border-radius: 10px; border: 2px solid #ddd; color: #007bff; font-weight: bold; }
        label { display: block; margin-top: 5px; color: #666; font-size: 14px; }
        .btn-group { display: flex; gap: 10px; margin-top: 25px; }
        button { flex: 1; padding: 15px; font-size: 18px; border-radius: 10px; border: none; cursor: pointer; color: white; font-weight: bold; transition: 0.2s; box-shadow: 0 2px 5px rgba(0,0,0,0.2); }
        button:active { transform: scale(0.95); }
        .btn-start { background: #28a745; }
        .btn-reset { background: #dc3545; }
        #status { margin-top: 20px; color: #888; font-size: 14px; min-height: 20px; }
        .link-section { margin-top: 30px; border-top: 1px solid #eee; padding-top: 20px; }
        .link-input { width: 90%; padding: 10px; font-size: 12px; color: #555; border: 1px solid #ccc; border-radius: 5px; background: #f9f9f9; }
        .btn-copy { background: #6c757d; font-size: 14px; padding: 8px; margin-top: 10px; width: auto; flex: none; display: inline-block; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üì± ‡∏£‡∏µ‡πÇ‡∏°‡∏ó‡∏Ñ‡∏∏‡∏°‡πÄ‡∏ß‡∏•‡∏≤</h1>
        <div class="input-box">
            <input type="number" id="sec" value="60" min="1">
            <label>‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ô‡∏±‡∏ö</label>
        </div>
        <div class="btn-group">
            <button class="btn-reset" onclick="sendReset()">‚èπÔ∏è Reset (0)</button>
            <button class="btn-start" onclick="sendStart()">‚ñ∂Ô∏è Start (‡πÄ‡∏£‡∏¥‡πà‡∏°)</button>
        </div>
        <div id="status">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞: ‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠...</div>
        <div class="link-section">
            <p style="font-size: 14px; color: #666; margin-bottom: 5px;">üëá ‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÉ‡∏™‡πà‡πÉ‡∏ô OBS / TIKTOK LIVE</p>
            <input type="text" id="overlayLink" class="link-input" readonly>
            <br>
            <button class="btn-copy" onclick="copyLink()">üìã ‡∏Å‡πä‡∏≠‡∏õ‡∏õ‡∏µ‡πâ‡∏•‡∏¥‡∏á‡∏Å‡πå</button>
        </div>
    </div>

    <script>
        // --- üîë ‡∏Å‡∏∏‡∏ç‡πÅ‡∏à Firebase ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì ---
        const firebaseConfig = {
            apiKey: "AIzaSyDgn9Vll-qcLhw7dcNtA9oGKy_BCRuefIs",
            authDomain: "control-tiktok.firebaseapp.com",
            databaseURL: "https://control-tiktok-default-rtdb.firebaseio.com",
            projectId: "control-tiktok",
            storageBucket: "control-tiktok.firebasestorage.app",
            messagingSenderId: "771700169818",
            appId: "1:771700169818:web:abe98c40c5b1baabab0c63",
            measurementId: "G-DZ76HRE0RM"
        };

        try {
            if (!firebase.apps.length) { firebase.initializeApp(firebaseConfig); }
            const db = firebase.database();
            document.getElementById('status').innerText = "‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞: ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ Server ‡πÅ‡∏•‡πâ‡∏ß ‚úÖ";
        } catch (e) {
            document.getElementById('status').innerText = "‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ ‚ùå";
        }

        const fixedLink = window.location.origin + "/overlay.html";
        document.getElementById('overlayLink').value = fixedLink;

        function sendStart() {
            const sec = parseInt(document.getElementById('sec').value) || 0;
            if (sec <= 0) return alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ‡πÉ‡∏´‡πâ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á");

            const now = new Date().getTime();
            
            // üî• ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Intro 3 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ (‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÇ‡∏ä‡∏ß‡πå‡∏Ñ‡∏≥‡∏ß‡πà‡∏≤ ‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏ö‡∏¥‡∏ô)
            const introTime = 3000; 
            
            const targetTime = now + (sec * 1000) + introTime; 

            firebase.database().ref('timer').set({
                mode: 'running',
                target: targetTime,
                duration: sec
            });
            document.getElementById('status').innerText = "‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞: ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ô‡∏±‡∏ö‡∏ñ‡∏≠‡∏¢‡∏´‡∏•‡∏±‡∏á... ‚è≥";
        }

        function sendReset() {
            firebase.database().ref('timer').set({
                mode: 'stop',
                target: 0
            });
            document.getElementById('status').innerText = "‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞: ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡πÄ‡∏õ‡πá‡∏ô 0 ‡πÅ‡∏•‡πâ‡∏ß ‚èπÔ∏è";
        }

        function copyLink() {
            const copyText = document.getElementById("overlayLink");
            copyText.select();
            document.execCommand("copy");
            alert("‡∏Å‡πä‡∏≠‡∏õ‡∏õ‡∏µ‡πâ‡∏•‡∏¥‡∏á‡∏Å‡πå‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢! ‡∏ô‡∏≥‡πÑ‡∏õ‡∏ß‡∏≤‡∏á‡πÉ‡∏ô OBS ‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢");
        }
    </script>
</body>
</html>
